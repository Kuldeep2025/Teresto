<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snakes and Ladders</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: #ecf0f1;
            transition: background 0.5s, color 0.3s;
            overflow-x: hidden;
        }
        body.dark-theme {
            background: linear-gradient(135deg, #1a3c34 0%, #14532d 100%);
            color: #d1fae5;
        }
        h1 {
            font-size: 3em;
            margin: 30px 0;
            text-shadow: 3px 3px 8px rgba(0,0,0,0.3);
            text-align: center;
            color: #22d3ee;
            animation: pulse 2s infinite;
        }
        body.dark-theme h1 {
            color: #38bdf8;
        }
        .container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 30px;
            position: relative;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            background: rgba(255, 255, 255, 0.85);
            border-radius: 25px;
            transition: transform 0.3s ease-in-out, box-shadow 0.3s;
        }
        .container:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.25);
        }
        body.dark-theme .container {
            background: rgba(17, 24, 39, 0.9);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }
        .navigate-up, .more-options {
            font-size: 2em;
            cursor: pointer;
            color: #22d3ee;
            position: absolute;
            padding: 15px;
            background: none;
            border: none;
            transition: color 0.3s, transform 0.2s;
        }
        .navigate-up:hover, .more-options:hover {
            color: #06b6d4;
            transform: scale(1.2);
        }
        .navigate-up {
            top: 20px;
            left: 20px;
        }
        .more-options {
            top: 20px;
            right: 20px;
        }
        button {
            padding: 15px 30px;
            margin: 10px;
            font-size: 1.3em;
            cursor: pointer;
            background: linear-gradient(45deg, #22d3ee, #06b6d4);
            color: #ffffff;
            border: none;
            border-radius: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }
        button:hover::before {
            left: 100%;
        }
        button:hover {
            background: linear-gradient(45deg, #06b6d4, #0284c7);
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        button:disabled {
            background: #6b7280;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        .scene {
            width: 120px;
            height: 120px;
            margin: 30px auto;
            perspective: 800px;
        }
        .cube {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transform: translateZ(-60px);
            transition: transform 1s ease-in-out;
        }
        .cube__face {
            position: absolute;
            width: 120px;
            height: 120px;
            border: 3px solid #ffffff;
            line-height: 120px;
            font-size: 28px;
            font-weight: bold;
            color: #ffffff;
            text-align: center;
            background: linear-gradient(45deg, #ef4444, #dc2626);
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }
        .cube__face--1 { transform: rotateY(0deg) translateZ(60px); }
        .cube__face--2 { transform: rotateY(90deg) translateZ(60px); }
        .cube__face--3 { transform: rotateY(180deg) translateZ(60px); }
        .cube__face--4 { transform: rotateY(-90deg) translateZ(60px); }
        .cube__face--5 { transform: rotateX(90deg) translateZ(60px); }
        .cube__face--6 { transform: rotateX(-90deg) translateZ(60px); }
        .cube.show-1 { transform: translateZ(-60px) rotateY(0deg); }
        .cube.show-2 { transform: translateZ(-60px) rotateY(-90deg); }
        .cube.show-3 { transform: translateZ(-60px) rotateY(-180deg); }
        .cube.show-4 { transform: translateZ(-60px) rotateY(90deg); }
        .cube.show-5 { transform: translateZ(-60px) rotateX(-90deg); }
        .cube.show-6 { transform: translateZ(-60px) rotateX(90deg); }
        .cube.rolling {
            animation: roll 0.6s ease-in-out;
        }
        .section {
            padding: 30px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            margin-bottom: 30px;
            animation: fadeIn 0.6s ease-in-out;
            transition: background 0.3s;
        }
        body.dark-theme .section {
            background: rgba(31, 41, 55, 0.9);
        }
        .hidden {
            display: none;
        }
        .dropdown, input[type="text"], input[type="file"], textarea {
            padding: 14px;
            margin: 10px 0;
            border-radius: 10px;
            border: 2px solid #4b5563;
            width: 250px;
            transition: border-color 0.3s, box-shadow 0.3s;
            background: #f3f4f6;
        }
        .dropdown:focus, input[type="text"]:focus, input[type="file"]:focus, textarea:focus {
            border-color: #22d3ee;
            box-shadow: 0 0 8px rgba(34, 211, 238, 0.5);
            outline: none;
        }
        .slider {
            width: 250px;
            margin: 15px 0;
            accent-color: #22d3ee;
            transition: all 0.3s;
        }
        .win-message, .lose-message {
            font-size: 2em;
            font-weight: bold;
            text-align: center;
            margin-top: 30px;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }
        .win-message {
            color: #22c55e;
            animation: bounce 1s infinite;
        }
        .lose-message {
            color: #ef4444;
            animation: shake 0.5s;
        }
        #gameStatus, #botStatus {
            font-size: 1.4em;
            margin: 15px 0;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #userAvatar, #botAvatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-right: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: transform 0.3s;
        }
        #userAvatar:hover, #botAvatar:hover {
            transform: scale(1.1);
        }
        p {
            margin: 15px 0;
            font-size: 1.3em;
            line-height: 1.6;
        }
        .focusable:focus {
            outline: 3px solid #22d3ee;
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.5);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        @keyframes roll {
            0% { transform: translateZ(-60px) rotateX(0deg) rotateY(0deg); }
            50% { transform: translateZ(-60px) rotateX(360deg) rotateY(360deg); }
            100% { transform: translateZ(-60px) rotateX(720deg) rotateY(720deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Accessible Snakes and Ladders</h1>

        <!-- Main Screen -->
        <div id="mainScreen" class="section" aria-label="Main Menu">
            <button class="more-options focusable" onclick="showMoreOptions()" aria-label="More Options">☰</button>
            <p>Snakes and Ladders</p>
            <button onclick="startGame()" aria-label="Start Game">Start Game</button>
        </div>

        <!-- More Options -->
        <div id="moreOptions" class="section hidden" aria-label="More Options Menu">
            <button class="navigate-up focusable" onclick="backToMain()" aria-label="Navigate Back to Main Menu">⬅</button>
            <button onclick="showHowToPlay()" aria-label="How to Play">How to Play</button>
            <button onclick="showSettings()" aria-label="Settings">Settings</button>
            <button onclick="showGameInfo()" aria-label="Game Information">Game Information</button>
            <button onclick="showCopyright()" aria-label="Copyright Details">Copyright Details</button>
            <button onclick="showProfile()" aria-label="User Profile">User Profile</button>
        </div>

        <!-- How to Play -->
        <div id="howToPlay" class="section hidden" aria-label="How to Play Instructions">
            <button class="navigate-up focusable" onclick="backToMoreOptions()" aria-label="Navigate Back to More Options">⬅</button>
            <h2>How to Play</h2>
            <div id="howToPlayText"></div>
        </div>

        <!-- Settings -->
        <div id="settings" class="section hidden" aria-label="Settings Menu">
            <button class="navigate-up focusable" onclick="backToMoreOptions()" aria-label="Navigate Back to More Options">⬅</button>
            <h2>Settings</h2>
            <h3>General</h3>
            <button onclick="showProfileSettings()" aria-label="Profile Settings">Profile Settings</button>
            <label>Game Language:
                <select id="gameLanguage" onchange="changeLanguage()" aria-label="Select Game Language">
                    <option value="en">English</option>
                    <option value="hi">Hindi</option>
                </select>
            </label>
            <br>
            <label>Dark Theme:
                <input type="checkbox" id="darkTheme" onchange="toggleDarkTheme()" aria-label="Toggle Dark Theme">
            </label>
            <h3>Audio Settings</h3>
            <label>Background Music:
                <input type="checkbox" id="bgMusicToggle" onchange="toggleBgMusic()" aria-label="Toggle Background Music">
            </label>
            <br>
            <label>Background Music Volume:
                <input type="range" id="bgMusicVolume" class="slider" min="0" max="100" value="10" onchange="adjustBgMusicVolume()" aria-label="Adjust Background Music Volume">
            </label>
            <br>
            <label>Preset Audio Volume:
                <input type="range" id="presetVolume" class="slider" min="0" max="100" value="10" onchange="adjustPresetVolume()" aria-label="Adjust Preset Audio Volume">
            </label>
            <br>
            <label>Effects and TTS Volume:
                <input type="range" id="effectsVolume" class="slider" min="0" max="100" value="100" onchange="adjustEffectsVolume()" aria-label="Adjust Effects and TTS Volume">
            </label>
            <br>
            <label>Commentary:
                <input type="checkbox" id="commentaryToggle" onchange="toggleCommentary()" aria-label="Toggle Commentary">
            </label>
            <br>
            <button onclick="showManageSounds()" aria-label="Manage Sounds and Effects">Manage Sounds and Effects</button>
            <button onclick="showCustomCommentary()" aria-label="Edit Custom Commentary">Edit Custom Commentary</button>
            <button onclick="showTtsVoice()" aria-label="Change TTS Voice">Change TTS Voice</button>
            <br>
            <button onclick="saveSettings()" aria-label="Save Settings">Save</button>
            <button onclick="cancelSettings()" aria-label="Cancel Settings">Cancel</button>
            <button onclick="resetSettings()" aria-label="Reset Settings to Default">Reset to Default</button>
        </div>

        <!-- Profile Settings -->
        <div id="profileSettings" class="section hidden" aria-label="Profile Settings">
            <button class="navigate-up focusable" onclick="backToSettings()" aria-label="Navigate Back to Settings">⬅</button>
            <h2>Profile Settings</h2>
            <label>Username: <input type="text" id="username" placeholder="Enter username" aria-label="Enter Username"></label>
            <br>
            <label>Profile Photo: <input type="file" id="profilePhoto" accept="image/*" aria-label="Upload Profile Photo"></label>
            <br>
            <img id="profilePreview" style="max-width: 120px; border-radius: 50%; display: none;" alt="Profile Photo Preview">
            <button onclick="saveProfile()" aria-label="Save Profile">Save</button>
            <button onclick="cancelProfile()" aria-label="Cancel Profile Changes">Cancel</button>
        </div>

        <!-- Manage Sounds -->
        <div id="manageSounds" class="section hidden" aria-label="Manage Sounds and Effects">
            <button class="navigate-up focusable" onclick="backToSettings()" aria-label="Navigate Back to Settings">⬅</button>
            <h2>Manage Sounds and Effects</h2>
            <div id="soundOptions"></div>
            <button onclick="saveSounds()" aria-label="Save Sound Changes">Save</button>
            <button onclick="cancelSounds()" aria-label="Cancel Sound Changes">Cancel</button>
        </div>

        <!-- Custom Commentary -->
        <div id="customCommentary" class="section hidden" aria-label="Edit Custom Commentary">
            <button class="navigate-up focusable" onclick="backToSettings()" aria-label="Navigate Back to Settings">⬅</button>
            <h2>Edit Custom Commentary</h2>
            <div id="commentaryOptions"></div>
            <button onclick="saveCommentary()" aria-label="Save Commentary">Save</button>
            <button onclick="cancelCommentary()" aria-label="Cancel Commentary Changes">Cancel</button>
        </div>

        <!-- TTS Voice -->
        <div id="ttsVoice" class="section hidden" aria-label="Change TTS Voice">
            <button class="navigate-up focusable" onclick="backToSettings()" aria-label="Navigate Back to Settings">⬅</button>
            <h2>Change TTS Voice</h2>
            <label>Voice:
                <select id="ttsVoiceSelect" aria-label="Select TTS Voice"></select>
            </label>
            <button onclick="saveTtsVoice()" aria-label="Save TTS Voice">Save</button>
            <button onclick="cancelTtsVoice()" aria-label="Cancel TTS Voice Changes">Cancel</button>
        </div>

        <!-- Game Area -->
        <div id="gameArea" class="section hidden" aria-label="Game Area" aria-live="polite">
            <img id="gameProfilePhoto" style="max-width: 60px; border-radius: 50%; display: none;" alt="Player Profile Photo">
            <div style="display: flex; align-items: center;">
                <img id="userAvatar" src="player.png" alt="User Avatar">
                <div id="gameStatus">Game ready. Your position: 1</div>
            </div>
            <div style="display: flex; align-items: center;">
                <img id="botAvatar" src="bot.png" alt="Bot Avatar">
                <div id="botStatus">Bot's position: 1</div>
            </div>
            <button id="rollDiceButton" onclick="rollDice()" aria-label="Roll Dice">Roll Dice</button>
            <div class="scene" aria-label="Dice Result">
                <div class="cube">
                    <div class="cube__face cube__face--1">1</div>
                    <div class="cube__face cube__face--2">2</div>
                    <div class="cube__face cube__face--3">3</div>
                    <div class="cube__face cube__face--4">4</div>
                    <div class="cube__face cube__face--5">5</div>
                    <div class="cube__face cube__face--6">6</div>
                </div>
            </div>
            <button onclick="resetGame()" aria-label="Reset Game">Reset Game</button>
        </div>

        <!-- Game Info -->
        <div id="gameInfo" class="section hidden" aria-label="Game Information">
            <button class="navigate-up focusable" onclick="backToMoreOptions()" aria-label="Navigate Back to More Options">⬅</button>
            <h2>Game Information</h2>
            <div id="snakesLaddersInfo"></div>
        </div>

        <!-- Copyright -->
        <div id="copyright" class="section hidden" aria-label="Copyright Details">
            <button class="navigate-up focusable" onclick="backToMoreOptions()" aria-label="Navigate Back to More Options">⬅</button>
            <h2>Copyright Details</h2>
            <div id="copyrightText"></div>
        </div>

        <!-- Profile -->
        <div id="profile" class="section hidden" aria-label="User Profile">
            <button class="navigate-up focusable" onclick="backToMoreOptions()" aria-label="Navigate Back to More Options">⬅</button>
            <h2>User Profile</h2>
            <div id="profileDetails"></div>
        </div>

        <!-- Win/Lose Messages -->
        <div id="winMessage" class="win-message hidden" aria-label="You Won">Yay, you’ve triumphed in this game!</div>
        <div id="loseMessage" class="lose-message hidden" aria-label="Bot Won">Gosh, you didn’t quite make it this time, but the bot did! No sweat, let's give it another shot.</div>
    </div>

    <!-- Audio Elements -->
    <audio id="backgroundMusic" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/Bgm.mp3" preload="auto" loop></audio>
    <audio id="diceSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3" preload="auto"></audio>
    <audio id="moveSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3" preload="auto"></audio>
    <audio id="winSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/winsound.mp3" preload="auto"></audio>
    <audio id="botMoveSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3" preload="auto"></audio>
    <audio id="botWinSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/Loose%20game.mp3" preload="auto"></audio>
    <audio id="turnSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/reset.mp3" preload="auto"></audio>
    <audio id="resetSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/preset.mp3" loop preload="auto"></audio>
    <audio id="ladderSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/climb.mp3" preload="auto"></audio>
    <audio id="snakeBiteSound" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/snake-sound-effect.mp3" preload="auto"></audio>
    <audio id="playerDice1" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound1.mp3" preload="auto"></audio>
    <audio id="playerDice2" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound2.mp3" preload="auto"></audio>
    <audio id="playerDice3" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound3.mp3" preload="auto"></audio>
    <audio id="playerDice4" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound4.mp3" preload="auto"></audio>
    <audio id="playerDice5" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound5.mp3" preload="auto"></audio>
    <audio id="playerDice6" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound6.mp3" preload="auto"></audio>
    <audio id="botDice1" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound7.mp3" preload="auto"></audio>
    <audio id="botDice2" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound8.mp3" preload="auto"></audio>
    <audio id="botDice3" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound9.mp3" preload="auto"></audio>
    <audio id="botDice4" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound10.mp3" preload="auto"></audio>
    <audio id="botDice5" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound11.mp3" preload="auto"></audio>
    <audio id="botDice6" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound12.mp3" preload="auto"></audio>
    <audio id="ladderHindi" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/ladder_hindi.mp3" preload="auto"></audio>
    <audio id="snakeBiteHindi" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/snake_bite_hindi.mp3" preload="auto"></audio>
    <audio id="winHindi" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/win_hindi.mp3" preload="auto"></audio>
    <audio id="botWinHindi" src="https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/bot_win_hindi.mp3" preload="auto"></audio>

    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
    <script>
        // Game State
        let position = 1, botPosition = 1, isPlayerTurn = true, gameOver = false, canRollDice = false, hasRolled = false;
        let backgroundMusic, resetSound, rollDiceButton = document.getElementById("rollDiceButton"), botMoveTimeout, gameStarted = false;
        let currentLanguage = 'en', playerName = '', rollTimeout;
        let settings = JSON.parse(localStorage.getItem('settings')) || {
            language: 'en', darkTheme: false, bgMusic: true, bgMusicVolume: 10, presetVolume: 10, effectsVolume: 100, commentary: true, ttsVoice: 'Brian'
        };
        let profile = JSON.parse(localStorage.getItem('profile')) || { username: '', photo: '', wins: 0, botWins: 0, ladders: 0, snakes: 0 };
        let sounds = JSON.parse(localStorage.getItem('sounds')) || {
            diceSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3',
            moveSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3',
            winSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/winsound.mp3',
            botMoveSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3',
            botWinSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/Loose%20game.mp3',
            turnSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/reset.mp3',
            ladderSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/climb.mp3',
            snakeBiteSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/snake-sound-effect.mp3',
            playerDice1: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound1.mp3',
            playerDice2: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound2.mp3',
            playerDice3: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound3.mp3',
            playerDice4: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound4.mp3',
            playerDice5: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound5.mp3',
            playerDice6: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound6.mp3',
            botDice1: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound7.mp3',
            botDice2: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound8.mp3',
            botDice3: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound9.mp3',
            botDice4: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound10.mp3',
            botDice5: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound11.mp3',
            botDice6: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound12.mp3',
            ladderHindi: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/ladder_hindi.mp3',
            snakeBiteHindi: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/snake_bite_hindi.mp3',
            winHindi: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/win_hindi.mp3',
            botWinHindi: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/bot_win_hindi.mp3'
        };
        let soundToggles = JSON.parse(localStorage.getItem('soundToggles')) || {
            diceSound: true, moveSound: true, winSound: true, botMoveSound: true, botWinSound: true, turnSound: true,
            ladderSound: true, snakeBiteSound: true, playerDice1: true, playerDice2: true, playerDice3: true,
            playerDice4: true, playerDice5: true, playerDice6: true, botDice1: true, botDice2: true, botDice3: true,
            botDice4: true, botDice5: true, botDice6: true, ladderHindi: true, snakeBiteHindi: true, winHindi: true,
            botWinHindi: true
        };
        let customCommentary = JSON.parse(localStorage.getItem('commentary')) || {};
        let ttsQueue = [], isTtsSpeaking = false;
        const cube = document.querySelector('.cube');

        const snakesAndLadders = { 2: 38, 7: 14, 8: 31, 15: 26, 21: 42, 28: 84, 36: 44, 51: 67, 71: 91, 78: 98, 87: 94, 16: 6, 46: 25, 49: 11, 62: 19, 64: 60, 74: 53, 89: 68, 92: 88, 95: 75, 99: 80 };

        const content = {
            en: {
                translations: {
                    gameReady: "Game ready. ",
                    botLocation: "Bot's position: ",
                    roll: " rolled ",
                    rolled: "rolled",
                    youAreAt: "'s position is ",
                    botPositionIs: "Bot position is",
                    wouldGoOver: " would go over, so they stay at ",
                    climbedLadder: " climbed a ladder and is now at ",
                    snakeBite: " was bitten by a snake and slid down to ",
                    yourPosition: "'s position is ",
                    botRolled: "The bot rolled ",
                    botWouldGoOver: "The bot would go over, so it stays at ",
                    botClimbedLadder: "The bot climbed a ladder, reaching ",
                    botSnakeBite: "The bot was bitten by a snake and slid down to ",
                    nowYourTurn: ", it's your turn! Please roll the dice.",
                    winMessage: "Congratulations! You won this game!",
                    loseMessage: "The bot won! Better luck next time.",
                    resetMessage: "Game has been reset. ",
                    startGameMessage: "Welcome to the game, ",
                    timeUp: ", time's up! Bot's turn now."
                },
                howToPlay: [
                    "Swipe up to start the game.",
                    "Try to roll the dice within 5 seconds after you listen to the instruction to roll.",
                    "Swipe right to roll the dice and move your piece on Android.",
                    "Swipe left to reset the game.",
                    "The first player to reach position 100 triumphs in the game.",
                    "The game is turn-based, so wait for your turn after rolling.",
                    "You have 7 seconds to roll the dice after your turn begins."
                ],
                gameInfo: Object.entries(snakesAndLadders).map(([start, end]) => 
                    `Position ${start} ${end > start ? 'has a ladder to' : 'has a snake to'} ${end}`
                ),
                copyright: [
                    "© 2025 Snakes and Ladders by TERESTO, created by Kuldeep Behera in collaboration with Jaskaran Singh.",
                    "All rights reserved.",
                    "This game, including its code, design, audio, and visual elements, is the intellectual property of the mini project Teresto."
                ]
            },
            hi: {
                translations: {
                    gameReady: "गेम तैयार है। ",
                    botLocation: "बॉट की स्थिति: ",
                    roll: " ने फेंका ",
                    rolled: "ने फेंका",
                    youAreAt: " की स्थिति है ",
                    botPositionIs: "बॉट की स्थिति है ",
                    wouldGoOver: " , आप आगे निकल जाते, इसलिए आप  वहीं पर रहते हैं ",
                    climbedLadder: " ने एक सीढ़ी चढ़ी और अब वह है ",
                    snakeBite: " को सांप ने काट लिया और वह नीचे फिसल गया ",
                    yourPosition: " की स्थिति है ",
                    botRolled: "बॉट ने फेंका ",
                    botWouldGoOver: "बॉट आगे निकल जाता, इसलिए वह वहीं पर रहता है ",
                    botClimbedLadder: "बॉट ने एक सीढ़ी चढ़ी और वह पहुंच गया ",
                    botSnakeBite: "बॉट को सांप ने काट लिया और वह नीचे फिसल गया ",
                    nowYourTurn: " अब आपकी बारी है! कृपया डाइस फेंकें।",
                    winMessage: "बधाई हो! आप जीत गए!",
                    loseMessage: "बॉट जीत गया! अगली बार बेहतर किस्मत।",
                    resetMessage: "गेम रीसेट हो गया है। ",
                    startGameMessage: "गेम में आपका स्वागत है, ",
                    timeUp: " समय समाप्त हो गया! अब बॉट की बारी।"
                },
                howToPlay: [
                    "गेम शुरू करने के लिए ऊपर स्वाइप करें।",
                    "रोल करने की सूचना सुनने के 5 सेकंड के भीतर डाइस रोल करने की कोशिश करें।",
                    "एंड्रॉइड पर डाइस रोल करने और अपनी चाल चलने के लिए दाएं स्वाइप करें।",
                    "गेम रीसेट करने के लिए बाएं स्वाइप करें।",
                    "गेम में 100वें स्थान पर पहुंचने वाला पहला खिलाड़ी जीतता है।",
                    "गेम बारी-बारी से खेला जाता है, इसलिए डाइस रोल करने के बाद अपनी बारी का इंतजार करें।",
                    "आपकी बारी शुरू होने के बाद आपके पास डाइस रोल करने के लिए 7 सेकंड हैं।"
                ],
                gameInfo: Object.entries(snakesAndLadders).map(([start, end]) => 
                    `स्थान ${start} ${end > start ? 'सीढ़ी से जाता है' : 'सांप से जाता है'} ${end}`
                ),
                copyright: ["यह गेम कुल्दीप बेहेरा और जसकरण सिंघ द्वारा बनया गया है. इस गेम का कोई दुरउपयोग करना, किसी प्रकार का कोड़ कौपी या चेंज करना, या इस"]
            }
        };

        // Audio Functions
        function playSound(soundId) {
            if (soundToggles[soundId]) {
                const sound = document.getElementById(soundId);
                sound.volume = settings.effectsVolume / 100;
                sound.play();
            }
        }

        function playDiceSound(dice, isPlayer) {
            const soundId = isPlayer ? `playerDice${dice}` : `botDice${dice}`;
            playSound(soundId);
        }

        function speakText(text, callback) {
            if (!settings.commentary) { if (callback) callback(); return; }
            ttsQueue.push({ text, callback });
            if (!isTtsSpeaking) processTtsQueue();
        }

        function processTtsQueue() {
            if (ttsQueue.length === 0) {
                isTtsSpeaking = false;
                return;
            }
            isTtsSpeaking = true;
            const { text, callback } = ttsQueue.shift();
            const ttsApiUrl = `https://advanced-tts.darkhacker7301.workers.dev/?message=${encodeURIComponent(text)}&voice=${settings.ttsVoice}`;
            const audio = new Audio(ttsApiUrl);
            audio.volume = settings.effectsVolume / 100;
            audio.play();
            audio.onended = () => {
                setTimeout(() => {
                    if (callback) callback();
                    processTtsQueue();
                }, 30);
            };
        }

        // Language and UI Updates
        function updateText() {
            const lang = content[currentLanguage].translations;
            document.getElementById("rollDiceButton").textContent = "Roll Dice";
            document.getElementById("gameStatus").textContent = `${lang.gameReady}${playerName}${lang.youAreAt}${position}`;
            document.getElementById("botStatus").textContent = `${lang.botLocation}${botPosition}`;
        }

        // Game Logic
        function startGame() {
            playerName = profile.username || localStorage.getItem('playerName') || '';
            if (!playerName) {
                alert(currentLanguage === 'en' ? "Please set your username in Settings > Profile Settings!" : "कृपया सेटिंग्स > प्रोफाइल सेटिंग्स में अपना उपयोगकर्ता नाम सेट करें!");
                showSettings();
                showProfileSettings();
                return;
            }
            showSection('gameArea');
            document.getElementById("gameArea").setAttribute("aria-live", "off");
            document.getElementById("gameArea").setAttribute("aria-busy", "true");
            document.getElementById("gameArea").setAttribute("aria-modal", "true");

            backgroundMusic = document.getElementById("backgroundMusic");
            backgroundMusic.loop = true;
            backgroundMusic.volume = settings.bgMusicVolume / 100;
            if (settings.bgMusic) backgroundMusic.play();

            resetSound = document.getElementById("resetSound");
            resetSound.loop = true;
            resetSound.volume = settings.presetVolume / 100;
            if (settings.bgMusic) resetSound.play();

            resetGame();
            const lang = content[currentLanguage].translations;
            speakText(`${lang.startGameMessage}${playerName}! ${currentLanguage === 'en' ? "Please roll the dice." : "कृपया डाइस फेंकें।"}`, () => {
                enableRollDice();
                canRollDice = true;
                startRollTimer();
            });

            gameStarted = true;
            document.getElementById('gameProfilePhoto').src = profile.photo || '';
            document.getElementById('gameProfilePhoto').style.display = profile.photo ? 'block' : 'none';
        }

        function startRollTimer() {
            clearTimeout(rollTimeout);
            rollTimeout = setTimeout(() => {
                if (isPlayerTurn && !gameOver && !hasRolled) {
                    const lang = content[currentLanguage].translations;
                    disableRollDice();
                    canRollDice = false;
                    speakText(`${playerName}${lang.timeUp}`, () => {
                        isPlayerTurn = false;
                        hasRolled = false;
                        botMoveTimeout = setTimeout(botTurn, 500);
                    });
                }
            }, 7000);
        }

        function rollDice() {
            if (gameOver || !isPlayerTurn || !canRollDice || hasRolled) return;
            clearTimeout(rollTimeout);
            disableRollDice();
            canRollDice = false;
            hasRolled = true;

            const dice = Math.floor(Math.random() * 6) + 1;
            playDiceSound(dice, true);
            let newPosition = position + dice;
            const lang = content[currentLanguage].translations;

            cube.classList.add('rolling');
            setTimeout(() => {
                cube.classList.remove('show-1', 'show-2', 'show-3', 'show-4', 'show-5', 'show-6', 'rolling');
                cube.classList.add(`show-${dice}`);
            }, 600);

            let statusText = `${playerName}${lang.roll}${dice}.`;
            document.getElementById("gameStatus").textContent = statusText;
            speakText(statusText);

            if (newPosition > 100) {
                statusText = `${playerName}${lang.wouldGoOver}${position}.`;
                document.getElementById("gameStatus").textContent = statusText;
                speakText(statusText);
                newPosition = position;
            }

            position = newPosition;

            if (snakesAndLadders[position]) {
                const oldPosition = position;
                position = snakesAndLadders[position];
                if (position > oldPosition) {
                    statusText = `${playerName}${lang.climbedLadder}${position}.`;
                    document.getElementById("gameStatus").textContent = statusText;
                    speakText(statusText);
                    playSound("ladderSound");
                    if (currentLanguage === 'hi') playSound("ladderHindi");
                    profile.ladders++;
                } else {
                    statusText = `${playerName}${lang.snakeBite}${position}.`;
                    document.getElementById("gameStatus").textContent = statusText;
                    speakText(statusText);
                    playSound("snakeBiteSound");
                    if (currentLanguage === 'hi') playSound("snakeBiteHindi");
                    profile.snakes++;
                }
            }

            if (position === 100) {
                handleWin();
            } else {
                statusText = `${playerName}${lang.yourPosition}${position}`;
                document.getElementById("gameStatus").textContent = statusText;
                speakText(statusText, () => {
                    playSound("moveSound");
                    isPlayerTurn = false;
                    botMoveTimeout = setTimeout(botTurn, 500);
                });
            }
        }

        function botTurn() {
            if (gameOver) return;
            clearTimeout(botMoveTimeout);

            const botDice = Math.floor(Math.random() * 6) + 1;
            playDiceSound(botDice, false);
            let newBotPosition = botPosition + botDice;
            const lang = content[currentLanguage].translations;

            cube.classList.add('rolling');
            setTimeout(() => {
                cube.classList.remove('show-1', 'show-2', 'show-3', 'show-4', 'show-5', 'show-6', 'rolling');
                cube.classList.add(`show-${botDice}`);
            }, 600);

            let statusText = `${lang.botRolled}${botDice}.`;
            document.getElementById("botStatus").textContent = statusText;
            speakText(statusText);

            if (newBotPosition > 100) {
                statusText = `${lang.botWouldGoOver}${botPosition}.`;
                document.getElementById("botStatus").textContent = statusText;
                speakText(statusText);
                newBotPosition = botPosition;
            }

            botPosition = newBotPosition;

            if (snakesAndLadders[botPosition]) {
                const oldBotPosition = botPosition;
                botPosition = snakesAndLadders[botPosition];
                if (botPosition > oldBotPosition) {
                    statusText = `${lang.botClimbedLadder}${botPosition}.`;
                    document.getElementById("botStatus").textContent = statusText;
                    speakText(statusText);
                    playSound("ladderSound");
                } else {
                    statusText = `${lang.botSnakeBite}${botPosition}.`;
                    document.getElementById("botStatus").textContent = statusText;
                    speakText(statusText);
                    playSound("snakeBiteSound");
                }
            }

            statusText = `${lang.botLocation}${botPosition}`;
            document.getElementById("botStatus").textContent = statusText;
            speakText(statusText, () => {
                playSound("botMoveSound");

                if (botPosition === 100) {
                    handleLose();
                } else {
                    const turnText = `${playerName}${lang.nowYourTurn}`;
                    document.getElementById("gameStatus").textContent = turnText;
                    speakText(turnText, () => {
                        playSound("turnSound");
                        isPlayerTurn = true;
                        hasRolled = false;
                        enableRollDice();
                        canRollDice = true;
                        startRollTimer();
                    });
                }
            });
        }

        function handleWin() {
            gameOver = true;
            clearTimeout(botMoveTimeout);
            clearTimeout(rollTimeout);
            canRollDice = false;
            const lang = content[currentLanguage].translations;
            const winText = `${currentLanguage === 'en' ? "Congratulations " : "बधाई "}${playerName}${currentLanguage === 'en' ? "! You won!" : "! आप जीत गए!"}`;
            document.getElementById("gameStatus").textContent = winText;
            speakText(lang.winMessage);
            playSound("winSound");
            if (currentLanguage === 'hi') playSound("winHindi");

            if (settings.bgMusic) {
                resetSound.pause();
                resetSound.currentTime = 0;
                backgroundMusic.pause();
                backgroundMusic.currentTime = 0;
            }

            document.getElementById("gameArea").removeAttribute("aria-live");
            document.getElementById("gameArea").removeAttribute("aria-busy");
            document.getElementById("gameArea").removeAttribute("aria-modal");
            showSection('winMessage');
            profile.wins++;
            saveProfileData();
        }

        function handleLose() {
            gameOver = true;
            clearTimeout(botMoveTimeout);
            clearTimeout(rollTimeout);
            canRollDice = false;
            const lang = content[currentLanguage].translations;
            const loseText = lang.loseMessage;
            document.getElementById("botStatus").textContent = loseText;

            if (settings.bgMusic) {
                resetSound.pause();
                resetSound.currentTime = 0;
                backgroundMusic.pause();
                backgroundMusic.currentTime = 0;
            }

            speakText(loseText, () => {
                playSound("botWinSound");
                if (currentLanguage === 'hi') playSound("botWinHindi");
            });

            document.getElementById("gameArea").removeAttribute("aria-live");
            document.getElementById("gameArea").removeAttribute("aria-busy");
            document.getElementById("gameArea").removeAttribute("aria-modal");
            showSection('loseMessage');
            profile.botWins++;
            saveProfileData();
        }

        function resetGame() {
            resetSound.currentTime = 0;
            position = 1;
            botPosition = 1;
            isPlayerTurn = true;
            gameOver = false;
            canRollDice = false;
            hasRolled = false;
            clearTimeout(botMoveTimeout);
            clearTimeout(rollTimeout);

            const lang = content[currentLanguage].translations;
            document.getElementById("gameStatus").textContent = `${lang.resetMessage}${playerName}${lang.youAreAt}${position}`;
            document.getElementById("botStatus").textContent = `${lang.botLocation}${botPosition}`;
            cube.classList.remove('show-1', 'show-2', 'show-3', 'show-4', 'show-5', 'show-6', 'rolling');

            speakText(`${lang.resetMessage}${playerName}${lang.youAreAt}${position}`, () => {
                const turnText = `${playerName}${lang.nowYourTurn}`;
                document.getElementById("gameStatus").textContent = turnText;
                speakText(turnText, () => {
                    enableRollDice();
                    canRollDice = true;
                    startRollTimer();
                });
            });

            showSection('gameArea');
            if (settings.bgMusic) {
                backgroundMusic.play();
                resetSound.play();
            }
        }

        function enableRollDice() {
            rollDiceButton.disabled = false;
            rollDiceButton.style.display = "inline-block";
        }

        function disableRollDice() {
            rollDiceButton.disabled = true;
            rollDiceButton.style.display = "inline-block";
        }

        // Navigation Functions
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            document.getElementById(id).focus();
        }
        function showMoreOptions() { showSection('moreOptions'); }
        function backToMain() { showSection('mainScreen'); }
        function backToMoreOptions() { showSection('moreOptions'); }
        function showHowToPlay() { 
            showSection('howToPlay'); 
            const container = document.getElementById('howToPlayText');
            container.innerHTML = content[currentLanguage].howToPlay.map(line => `<p tabindex="0">${line}</p>`).join('');
        }
        function showSettings() { showSection('settings'); loadSettings(); }
        function backToSettings() { showSection('settings'); }
        function showGameInfo() { 
            showSection('gameInfo'); 
            const container = document.getElementById('snakesLaddersInfo');
            container.innerHTML = content[currentLanguage].gameInfo.map(line => `<p tabindex="0">${line}</p>`).join('');
        }
        function showCopyright() { 
            showSection('copyright'); 
            const container = document.getElementById('copyrightText');
            container.innerHTML = content[currentLanguage].copyright.map(line => `<p tabindex="0">${line}</p>`).join('');
        }
        function showProfile() { showSection('profile'); updateProfile(); }

        // Settings Functions
        function loadSettings() {
            document.getElementById("gameLanguage").value = settings.language;
            document.getElementById("darkTheme").checked = settings.darkTheme;
            document.getElementById("bgMusicToggle").checked = settings.bgMusic;
            document.getElementById("bgMusicVolume").value = settings.bgMusicVolume;
            document.getElementById("presetVolume").value = settings.presetVolume;
            document.getElementById("effectsVolume").value = settings.effectsVolume;
            document.getElementById("commentaryToggle").checked = settings.commentary;
        }

        function showProfileSettings() {
            showSection('profileSettings');
            document.getElementById('username').value = profile.username;
            document.getElementById('profilePreview').src = profile.photo || '';
            document.getElementById('profilePreview').style.display = profile.photo ? 'block' : 'none';
        }

        function saveProfile() {
            profile.username = document.getElementById("username").value;
            playerName = profile.username;
            localStorage.setItem('playerName', playerName);
            const file = document.getElementById('profilePhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = () => { profile.photo = reader.result; saveProfileData(); backToSettings(); };
                reader.readAsDataURL(file);
            } else {
                saveProfileData();
                backToSettings();
            }
            updateText();
        }

        function cancelProfile() { backToSettings(); }

        function showManageSounds() {
            showSection('manageSounds');
            const container = document.getElementById('soundOptions');
            container.innerHTML = '';
            for (const [key, url] of Object.entries(sounds)) {
                const div = document.createElement('div');
                div.innerHTML = `
                    <label>${key.replace(/([A-Z])/g, ' $1').trim()}:
                        <input type="file" accept="audio/*" onchange="updateSound('${key}', this)" aria-label="Upload ${key} Sound">
                        <button onclick="previewSound('${url}')" aria-label="Preview ${key} Sound">Preview</button>
                        ${url !== defaultSounds[key] ? `<button onclick="removeSound('${key}')" aria-label="Remove ${key} Sound">Remove</button>` : ''}
                        <input type="checkbox" ${soundToggles[key] ? 'checked' : ''} onchange="toggleCustomSound('${key}', this.checked)" aria-label="Play ${key} Sound"> Play
                    </label>`;
                container.appendChild(div);
            }
        }

        const defaultSounds = {
            diceSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3',
            moveSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3',
            winSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/winsound.mp3',
            botMoveSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/role.mp3',
            botWinSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/Loose%20game.mp3',
            turnSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/reset.mp3',
            ladderSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/climb.mp3',
            snakeBiteSound: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/snake-sound-effect.mp3',
            playerDice1: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound1.mp3',
            playerDice2: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound2.mp3',
            playerDice3: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound3.mp3',
            playerDice4: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound4.mp3',
            playerDice5: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound5.mp3',
            playerDice6: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound6.mp3',
            botDice1: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound7.mp3',
            botDice2: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound8.mp3',
            botDice3: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound9.mp3',
            botDice4: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound10.mp3',
            botDice5: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound11.mp3',
            botDice6: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/sound12.mp3',
            ladderHindi: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/ladder_hindi.mp3',
            snakeBiteHindi: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/snake_bite_hindi.mp3',
            winHindi: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/win_hindi.mp3',
            botWinHindi: 'https://github.com/Interestingtechforvi/Home/raw/refs/heads/main/bot_win_hindi.mp3'
        };

        function updateSound(key, input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = () => { 
                    sounds[key] = reader.result; 
                    document.getElementById(key).src = sounds[key];
                };
                reader.readAsDataURL(file);
            }
        }

        function previewSound(url) {
            const audio = new Audio(url);
            audio.volume = settings.effectsVolume / 100;
            audio.play();
        }

        function removeSound(key) {
            sounds[key] = defaultSounds[key];
            document.getElementById(key).src = defaultSounds[key];
            showManageSounds();
        }

        function toggleCustomSound(key, checked) {
            soundToggles[key] = checked;
            localStorage.setItem('soundToggles', JSON.stringify(soundToggles));
        }

        function saveSounds() {
            localStorage.setItem('sounds', JSON.stringify(sounds));
            localStorage.setItem('soundToggles', JSON.stringify(soundToggles));
            backToSettings();
        }

        function cancelSounds() { backToSettings(); }

        function showCustomCommentary() {
            showSection('customCommentary');
            const container = document.getElementById('commentaryOptions');
            container.innerHTML = '';
            for (const key in content[settings.language].translations) {
                const input = document.createElement('textarea');
                input.value = customCommentary[key] || content[settings.language].translations[key];
                input.onchange = () => customCommentary[key] = input.value;
                input.setAttribute('aria-label', `Edit ${key} Commentary`);
                container.appendChild(document.createElement('label')).textContent = key;
                container.appendChild(input);
            }
        }

        function saveCommentary() {
            localStorage.setItem('commentary', JSON.stringify(customCommentary));
            backToSettings();
        }

        function cancelCommentary() { backToSettings(); }

        function showTtsVoice() {
            showSection('ttsVoice');
            const select = document.getElementById('ttsVoiceSelect');
            select.innerHTML = settings.language === 'en' ? `
                <option value="Brian">Brian (US)</option>
                <option value="Matthew">Matthew (US)</option>
                <option value="Joanna">Joanna (US)</option>
                <option value="Salli">Salli (US)</option>
                <option value="Raveena">Raveena (Indian)</option>
                <option value="Aditi">Aditi (Indian)</option>
            ` : `
                <option value="Hemant">Hemant (Indian)</option>
                <option value="Aditi">Aditi (Indian)</option>
                <option value="Kajal">Kajal (Indian)</option>
                <option value="Naja">Naja (Indian)</option>
            `;
            select.value = settings.ttsVoice;
        }

        function saveTtsVoice() {
            settings.ttsVoice = document.getElementById("ttsVoiceSelect").value;
            saveSettingsData();
            backToSettings();
        }

        function cancelTtsVoice() { backToSettings(); }

        function changeLanguage() {
            settings.language = document.getElementById("gameLanguage").value;
            currentLanguage = settings.language;
            updateText();
            saveSettingsData();
        }

        function toggleDarkTheme() {
            settings.darkTheme = document.getElementById("darkTheme").checked;
            document.body.classList.toggle('dark-theme', settings.darkTheme);
            saveSettingsData();
        }

        function toggleBgMusic() {
            settings.bgMusic = document.getElementById("bgMusicToggle").checked;
            if (backgroundMusic) {
                if (settings.bgMusic) backgroundMusic.play();
                else backgroundMusic.pause();
            }
            if (resetSound) {
                if (settings.bgMusic) resetSound.play();
                else resetSound.pause();
            }
            saveSettingsData();
        }

        function adjustBgMusicVolume() {
            settings.bgMusicVolume = document.getElementById("bgMusicVolume").value;
            if (backgroundMusic) backgroundMusic.volume = settings.bgMusicVolume / 100;
            saveSettingsData();
        }

        function adjustPresetVolume() {
            settings.presetVolume = document.getElementById("presetVolume").value;
            if (resetSound) resetSound.volume = settings.presetVolume / 100;
            saveSettingsData();
        }

        function adjustEffectsVolume() {
            settings.effectsVolume = document.getElementById("effectsVolume").value;
            document.querySelectorAll('audio:not(#backgroundMusic):not(#resetSound)').forEach(a => a.volume = settings.effectsVolume / 100);
            saveSettingsData();
        }

        function toggleCommentary() {
            settings.commentary = document.getElementById("commentaryToggle").checked;
            saveSettingsData();
        }

        function saveSettings() {
            saveSettingsData();
            backToMoreOptions();
        }

        function cancelSettings() { backToMoreOptions(); }

        function resetSettings() {
            settings = { language: 'en', darkTheme: false, bgMusic: true, bgMusicVolume: 10, presetVolume: 10, effectsVolume: 100, commentary: true, ttsVoice: 'Brian' };
            sounds = { ...defaultSounds };
            soundToggles = {
                diceSound: true, moveSound: true, winSound: true, botMoveSound: true, botWinSound: true, turnSound: true,
                ladderSound: true, snakeBiteSound: true, playerDice1: true, playerDice2: true, playerDice3: true,
                playerDice4: true, playerDice5: true, playerDice6: true, botDice1: true, botDice2: true, botDice3: true,
                botDice4: true, botDice5: true, botDice6: true, ladderHindi: true, snakeBiteHindi: true, winHindi: true,
                botWinHindi: true
            };
            customCommentary = {};
            localStorage.setItem('settings', JSON.stringify(settings));
            localStorage.setItem('sounds', JSON.stringify(sounds));
            localStorage.setItem('soundToggles', JSON.stringify(soundToggles));
            localStorage.setItem('commentary', JSON.stringify(customCommentary));
            loadSettings();
            updateUI();
            if (backgroundMusic) {
                backgroundMusic.volume = settings.bgMusicVolume / 100;
                settings.bgMusic ? backgroundMusic.play() : backgroundMusic.pause();
            }
            if (resetSound) {
                resetSound.volume = settings.presetVolume / 100;
                settings.bgMusic ? resetSound.play() : resetSound.pause();
            }
            adjustEffectsVolume();
        }

        // Utility Functions
        function updateProfile() {
            document.getElementById('profileDetails').innerHTML = `
                <img src="${profile.photo || ''}" style="max-width: 120px; border-radius: 50%; ${profile.photo ? '' : 'display: none;'}" alt="Profile Photo">
                <p tabindex="0">Username: ${profile.username}</p>
                <p tabindex="0">Player Wins: ${profile.wins}</p>
                <p tabindex="0">Bot Wins: ${profile.botWins}</p>
                <p tabindex="0">Ladders Climbed: ${profile.ladders}</p>
                <p tabindex="0">Snakes Bitten: ${profile.snakes}</p>`;
        }

        function saveProfileData() { localStorage.setItem('profile', JSON.stringify(profile)); }
        function saveSettingsData() { localStorage.setItem('settings', JSON.stringify(settings)); }

        // Initialization
        function updateUI() {
            document.getElementById("rollDiceButton").textContent = "Roll Dice";
            toggleDarkTheme();
            adjustBgMusicVolume();
            adjustPresetVolume();
            adjustEffectsVolume();
        }

        window.onload = () => {
            updateUI();
            const audioElements = document.querySelectorAll('audio');
            audioElements.forEach(sound => {
                sound.src = sounds[sound.id] || sound.src;
                sound.load();
            });

            resetSound = document.getElementById("resetSound");
            backgroundMusic = document.getElementById("backgroundMusic");
            disableRollDice();
            canRollDice = false;
            playerName = localStorage.getItem('playerName') || profile.username || '';
            currentLanguage = settings.language;
            updateText();
            if (settings.bgMusic) {
                backgroundMusic.volume = settings.bgMusicVolume / 100;
                resetSound.volume = settings.presetVolume / 100;
            } else {
                backgroundMusic.pause();
                resetSound.pause();
            }
            const hammer = new Hammer(document.body, { prevent_default: true });
            hammer.get('swipe').set({ direction: Hammer.DIRECTION_ALL });
            hammer.on('swipeup', (e) => {
                e.preventDefault();
                if (!gameStarted && !document.getElementById('mainScreen').classList.contains('hidden')) startGame();
            });
            hammer.on('swiperight', (e) => {
                e.preventDefault();
                if (canRollDice && gameStarted && !hasRolled) rollDice();
            });
            hammer.on('swipeleft', (e) => {
                e.preventDefault();
                if (gameStarted && !document.getElementById('gameArea').classList.contains('hidden')) resetGame();
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'r' || e.key === 'R') {
                    if (canRollDice && !hasRolled) rollDice();
                } else if (e.key === 'Enter' || e.key === ' ') {
                    const active = document.activeElement;
                    if (active.classList.contains('focusable')) active.click();
                }
            });
        };
    </script>
</body>
</html>